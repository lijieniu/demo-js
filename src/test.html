<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover"/>
	<meta name="format-detection" content="telephone=no, address=no">
    <meta name="keywords" content="豌豆公主,日淘,海淘,代购,母婴,海外代购,日本代购,正品,亚马逊,乐天,全球购,商城,包邮,亚马逊,特卖,减肥,零食,化妆品,美容,护肤,药妆,防晒,美白,丰胸" />
    <meta name="description" content="豌豆公主是目前唯一由日本供应商直接进驻的跨境电商平台，独家代理日本高端品牌，为您提供尊贵体验, 满¥288包日本直邮。" />
	
	<title>豌豆公主828周年庆</title>

	<style>
		.d-target {
			width: 100px;
			height: 100px;
			border: 1px solid #ccc;
			border-radius: 50%;
			position: absolute;
			left: 100px;
			bottom: 100px;
		}
		.outer {
			width: 30px;
			height: 30px;
			position: absolute;
			left: 0;
			top: 0;
			transition: all 0.35s linear;
		}
		.outer .inner {
			width: 30px;
			height: 30px;
			background: #ccc;
			border-radius: 50%;
			transition: all 0.35s cubic-bezier(0.39, -0.4. 0.83, 0.23);
			position: absolute;
		}
		.outer.point-pre {
			display: none;
		}
	</style>

	<style>
		.test{background: red;width: 50px;height:50px;}
	  </style>
	  <style>
		  	.parabola-animation{
				width: 100%;
			}
			.parabola-box-hor{
				position: fixed;
				top: 0;
				left: 0;
				z-index: 99;
				-webkit-animation: parabola-hor-animation 1s ease-out 1;
				animation: parabola-hor-animation 1s ease-out 1;
			}
			.parabola-box-hor.top{
				-webkit-animation-timing-function: ease-in;
						animation-timing-function: ease-in;
			}
			.parabola-box-ver{
				position: fixed;
				top: 50px;
				left: 20px;
				width: 35px;
				height: 35px;
				border-radius: 50%;
				overflow: hidden;
				-webkit-animation: parabola-ver-animation 1s ease-in 1;
				animation: parabola-ver-animation 1s ease-in 1;
			}
			.parabola-box-ver.top{
				-webkit-animation-timing-function: ease-out;
						animation-timing-function: ease-out;
			}
			.parabola-box-ver>img{
				width: 100%;
				height: 100%;
				vertical-align: middle;
			}
	  </style>
</head>
<body>
	
<div class="container">
	<!-- <p>在页面的任何位置点击，将有一个小球飞入类为d-target圆形容器中，可以连续点击</p>
	<div id="ttt" class="d-target"></div>
	<div class="outer">
		<div class="inner">

		</div>
	</div> -->
	<div class="parabola-animation">
		<div class="parabola-box-hor">
			<div class="parabola-box-ver">
				<img src="https://s3.wandougongzhu.cn/s/5a/feed-new_4662eb.png" />
			</div>
		</div>
	</div>
</div>
<!-- <script src="https://cdn.staticfile.org/zepto/1.0rc1/zepto.min.js"></script>
<script src="https://cdn.staticfile.org/jquery/3.3.1/jquery.min.js"></script>
<script src="fly.min.js"></script> -->
<script src="js/const.js"></script>

<script type="text/javascript">
    // 一个简单的测试：关于值传递和引用传递
    function changeAgeAndReference(person) {
        person.age = 25;
        person = { 
            name: 'John',
            age: 50
        };
        return person;
    }
    var personObj1 = {
        name: 'Alex',
        age: 30
    };
    var personObj2 = changeAgeAndReference(personObj1);
    console.log(personObj1);
    console.log(personObj2);

    // 单例设计模式：



    // 高阶函数
    // function add(x, y, f) {
    //     return f(x) + f(y);
    // }
    // var result = add(-5, 6, Math.abs);
    // console.log(result);

    // 闭包
    // 1.要了解闭包先要了解一下js中的作用域：全局和局部作用域；js中没有块级作用域：比如if语句中定义的变量
    // 无块级作用域
    if(true) {
        var a = 111;
    }
    console.log(a);

    function test() {
        var b = 222;
    }
    test();
    // console.log(b); // 报错

    // 如果在函数中定义一个变量没有使用var关键字，则该变量是一个全局变量
    function test2() {
        c = 333;
    }
    test2();
    console.log(c);

    // 那么我们怎样才能在全局中访问局部变量呢？
    function test3() {
        var a3 = 444;
        function t3() {
            return a3;
        }
        return t3;
    }
    console.log(test3()());
    // 什么是闭包？其实上面的t3就是一个闭包
    // 个人理解：闭包其实就是在函数内部嵌套的另一个函数，它的作用就是可以让全局作用域访问局部作用域中的变量
    // 使用闭包的作用：读取函数内部的变量；让这些变量始终保持在内存中；
    function f1() {
        var n = 999;
        nAdd = function() {
            n +=1;
        }
        function f2() {
            console.log(n);
        }
        return f2
    }
    var result = f1();
    result(); // 999
    nAdd(); // n = 1000
    result(); // 1000
    

    // javascript运行机制
    // 1.js运行是按照语句出现的顺序执行的
    var aa = 1;
    console.log(aa);
    var bb = 2;
    console.log(bb);

    setTimeout(function() {
        console.log('定时器开始啦');
    });

    new Promise(function(resolve) {
        console.log('创建一个新的Promise');
        resolve();
    }).then(function() {
        console.log('执行then');
    });
    console.log('代码执行结束');
    // 2.js是单线程语言，js中的任务：同步任务和异步任务
    // 同步任务会直接在主线程中执行，异步任务会进入一个event table，然后注册回调函数，当主线程上的任务执行完之后，主线程会调用事件队列中的
    // 回调函数进行执行
    // js引擎中存在monitoring process进程，会持续不断的检查主线程是否为空
    // var data = [];
    // $.ajax({
    //     url: 'www.baidu.com',
    //     data: data,
    //     success: function() {
    //         // 回调函数代码
    //     }
    // });

    // 3.setTimeout: 准确的说应该是x秒之后将task()放入事件队列中而不是立即执行
    setTimeout(function() {
        // task()
    }, 3000);
    // sleep(10000000); // 主线程sleep完之后再执行task
    // 任务：宏任务和微任务
    setTimeout(function() {
        console.log("setTimeout");
    });
    new Promise(function(resolve) {
        console.log('promise');
        resolve();
    }).then(function() {
        console.log('then');
    });
    console.log('console');

    // 终极例子
    console.log('1');

    setTimeout(function() {
        console.log('2');
        // process.nextTick(function() {
        //     console.log('3');
        // })
        new Promise(function(resolve) {
            console.log('4');
            resolve();
        }).then(function() {
            console.log('5')
        })
    })
    // process.nextTick(function() {
    //     console.log('6');
    // })
    new Promise(function(resolve) {
        console.log('7');
        resolve();
    }).then(function() {
        console.log('8')
    })

    setTimeout(function() {
        console.log('9');
        // process.nextTick(function() {
        //     console.log('10');
        // })
        new Promise(function(resolve) {
            console.log('11');
            resolve();
        }).then(function() {
            console.log('12')
        })
    })
    // function func1() {
    //     var a = 999;
    //     function func2() {
    //         console.log(a);
    //     }
    //     return func2;
    // }

    // var func = func1();
    // func();

    // var name = "The Window";
    // var object = {
    //     name: "My Object",
    //     getNameFunc: function() {
    //         return function() {
    //             return this.name;
    //         }
    //     }
    // }
    // console.log(object.getNameFunc()());
    // // console.log(object.getNameFunc().call(object));

    // var name2 = "The Window";
    // var object2 = {
    //     name: "My Object",
    //     getNameFunc: function() {
    //         var that = this;
    //         return function() {
    //             return that.name;
    //         }
    //     }
    // };
    // console.log(object2.getNameFunc()());


	// var flyer = jQuery('<img class="flyer-img" src="http://ossimg.wandougongzhu.cn/6deeeac606f5283ac44807046676cad4.png@360w_4000h_1l.webp">'); //抛物体对象   
	// 	flyer.fly({   
    //         start: {   
    //             left: event.pageX,//抛物体起点横坐标   
    //             top: jQuery(window).height() - 30 //抛物体起点纵坐标   
    //         },   
    //         end: {   
    //             left: jQuery('.fixed-operate-bar-cart-box').offset().left + 25,//抛物体终点横坐标   
    //             top: jQuery(window).height() - 30, //抛物体终点纵坐标   
    //         },   
    //         onEnd: function() {   
    //             $('.flyer-img').hide()
	// 		},
	// 		speed: 0.8   
    //     });

	// $('body').on('click', '.parabola-test.begin', function() {
	// 	addCar({
	// 		begin: $('.parabola-test.begin'),
	// 		end: $('.parabola-test.end'),
	// 		img: './img/logo.jpg',
	// 		callback: function() {
	// 			console.log('动画完成');
	// 		}
	// 	})
	// });

	// var addCar = function(opt){
    //     return (function(){
    //         var parabola = function(opt){
    //             this.init(opt);
    //         };
    //         parabola.prototype = {
    //             init: function(opt){
    //                 var flyO = this.calculatedValue(opt),
    //                     flyDom = this.creatHtml(flyO.site,flyO.img),
    //                     flyRule = this.creatRule(flyO.coord);

    //                 document.getElementsByTagName('head')[0].appendChild(flyRule);
    //                 document.body.appendChild(flyDom);
    //                 $('.parabola-animation').on('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend','.parabola-box-ver',function(){
    //                     var _pfly = $('.parabola-animation');
    //                     if(_pfly.length) _pfly.remove();
    //                     flyO.callback();
    //                 });
    //             },
	// 			creatHtml : function(site,img){
    //                 var imgHtml = img == '' ? '' : '![]('+img+')';

    //                 var html = '<div class="parabola-box-hor">\
    //                                 <div class="parabola-box-ver">\
    //                                     '+imgHtml+'\
    //                                 </div>\
    //                             </div>';

    //                 var parentBox = document.createElement('div');
    //                 parentBox.innerHTML = html;
    //                 parentBox.setAttribute('class','parabola-animation');

    //                 var frag = document.createDocumentFragment();
    //                 frag.appendChild(parentBox);

    //                 var verBox = frag.querySelector('.parabola-box-ver'),
    //                     horBpx = frag.querySelector('.parabola-box-hor');
    //                 verBox.style.left = site.left + 'px';
    //                 verBox.style.top = site.top + 'px';

    //                 if(site.cubic) {
    //                     verBox.setAttribute("class",'parabola-box-ver top');
    //                     horBpx.setAttribute("class",'parabola-box-hor top');
    //                 }
    //                 return frag;
    //             },
    //             creatRule:function(coord){
    //                 var cssAnimation = document.createElement('style');
    //                 cssAnimation.type="text/css";
    //                 var rules = "\
    //                         @-webkit-keyframes parabola-hor-animation{\
    //                             0%{\
    //                                 -webkit-transform: translate(0px, 0px);\
    //                                         transform: translate(0px, 0px);\
    //                             }\
    //                             10%{\
    //                                 -webkit-transform: translate(0px, 0px);\
    //                                         transform: translate(0px, 0px);\
    //                             }\
    //                             100%{\
    //                                 -webkit-transform: translate("+coord.x+"px, 0px);\
    //                                         transform: translate("+coord.x+"px, 0px);\
    //                             }\
    //                         }\
    //                         @keyframes parabola-hor-animation{\
    //                             0%{\
    //                                 -webkit-transform: translate(0px, 0px);\
    //                                         transform: translate(0px, 0px);\
    //                             }\
    //                             10%{\
    //                                 -webkit-transform: translate(0px, 0px);\
    //                                         transform: translate(0px, 0px);\
    //                             }\
    //                             100%{\
    //                                 -webkit-transform: translate("+coord.x+"px, 0px);\
    //                                         transform: translate("+coord.x+"px, 0px);\
    //                             }\
    //                         }\
    //                         @-webkit-keyframes parabola-ver-animation{\
    //                             0%{\
    //                                 -webkit-transform: translate(0px, 0px);\
    //                                         transform: translate(0px, 0px);\
    //                             }\
    //                             10%{\
    //                                 -webkit-transform: translate(0px, "+coord.os+"px);\
    //                                         transform: translate(0px, "+coord.os+"px);\
    //                             }\
    //                             100%{\
    //                                 -webkit-transform: translate(0px,"+coord.y+"px);\
    //                                         transform: translate(0px,"+coord.y+"px);\
    //                             }\
    //                         }\
    //                         @keyframes parabola-ver-animation{\
    //                             0%{\
    //                                 -webkit-transform: translate(0px, 0px);\
    //                                         transform: translate(0px, 0px);\
    //                             }\
    //                             10%{\
    //                                 -webkit-transform: translate(0px, "+coord.os+"px);\
    //                                         transform: translate(0px, "+coord.os+"px);\
    //                             }\
    //                             100%{\
    //                                 -webkit-transform: translate(0px,"+coord.y+"px);\
    //                                         transform: translate(0px,"+coord.y+"px);\
    //                             }\
    //                         }\
    //                     ";
    //                 cssAnimation.innerHTML = rules;
    //                 return cssAnimation;
	// 			},
	// 			calculatedValue:function(opt){
    //                 var fly = {
    //                     begin:'',
    //                     end: '',
    //                     img : '',
    //                     callback:function(){
    //                         console.log('动画完成');
    //                     }
    //                 },
    //                 vData = {
    //                     site:{
    //                         left: 0,
    //                         top: 0 ,
    //                         cubic: false
    //                     },
    //                     img: '',
    //                     coord:{
    //                         x: 0 ,
    //                         y: 0 ,
    //                         os: 0
    //                     },
    //                     callback: function(){}
    //                 },
    //                 _this = this ;

    //                 if( typeof opt == 'object'){
    //                     fly = $.extend(true, fly, opt);
    //                 }

    //                 //如果没有这两个元素中的其中一个则终止
    //                 if(!fly.begin.length || !fly.end.length) return vData;
    //                 /**
    //                  * beginCrood 获取开始元素的位置
    //                  * endCrood   获取结束元素的位置
    //                  */
    //                 var beginCrood = fly.begin[0].getBoundingClientRect(),
    //                     endCrood = fly.end[0].getBoundingClientRect();

    //                 /*!
    //                  *  购物车动画出现的位置
    //                  *  left: 开始元素的left+width/2
    //                  *  top: 开始元素的top
    //                  *  购物车动画结束的位置
    //                  *  x: 结束元素的left+width/2 再减去购物车动画出现的位置的left
    //                  *  y: 结束元素的top+height/2 再减去购物车动画出现的位置的top
    //                  */
    //                 /**
    //                  * 全部减去 18是因为购物车宽度和高度都是35px;一半难得算(-_-),就填18
    //                  */
    //                 vData.site.left = beginCrood.left + parseInt(beginCrood.width/2,10) -18;
    //                 vData.site.top = beginCrood.top -18;
    //                 vData.coord.x = endCrood.left + parseInt(endCrood.width/2,10) - vData.site.left -18;
    //                 vData.coord.y = endCrood.top + parseInt(endCrood.height/2,10) - vData.site.top -18;
    //                 vData.coord.os = -50;
    //                 vData.img = fly.img;
    //                 vData.callback = fly.callback;
    //                 if(beginCrood.top > endCrood.top) vData.site.cubic = true;
                    
    //                 return vData;
    //             }
    //         }
    //         return new parabola(opt);
    //     })();
    // }

// $('<div class="test"></div>').fly({
//       start: {top: 542, left: 622},
//       end: {top: 142, left: 322, width: 20, height: 20},
//       onEnd: function(){
//         alert('End');
//         this.destory();
//       }
//     });
    // window.onload = function() {
	// 	function addElements(CLASSNAME_OUTER, CLASSNAME_INNER) {
	// 		var outerWrapper = document.createElement('div');
	// 		var outer = null;
	// 		var inner = null;
	// 		for (var i = 0; i < 5; i++) {
	// 			outer = document.createElement('div');
	// 			outer.classList.add(CLASSNAME_OUTER);
	// 			outer.classList.add('point-pre');
	// 			inner = document.createElement('div');
	// 			inner.setAttribute('class', CLASSNAME_INNER);
	// 			outer.appendChild(inner);
	// 			outerWrapper.appendChild(outer);
	// 			inner = null;
	// 			outer = null;
	// 		}
	// 		document.body.appendChild(outerWrapper)
	// 		return outerWrapper
	// 	}

	// 	function getEndCoordinate(ele) {
	// 		var left = ele.offsetLeft;
	// 		var top = ele.offsetTop;
	// 		return [left, top]
	// 	}

	// 	function getElementMyShowHide(parentElement, CLASSNAME_SHOW_NONE) {
	// 		var result = null;
	// 		var childElements = parentElement.getElementsByClassName(CLASSNAME_SHOW_NONE);
	// 		result = childElements[0];
	// 		return result;
	// 	}

	// 	var CLASSNAME_OUTER = 'outer';
	// 	var CLASSNAME_INNER = 'inner';

	// 	// 增加小球元素
	// 	var outerWrapper = addElements(CLASSNAME_OUTER,CLASSNAME_INNER);
	// 	var endLeft = getEndCoordinate(document.getElementById('ttt'))[0];
	// 	var endTop  = getEndCoordinate(document.getElementById('ttt'))[1];

	// 	// 真实中的购物车实现是这里的click事件绑在添加购物车的按钮或者类似按钮的dom上
	// 	window.addEventListener('click', function (event) {
	// 		// 当双击的时候,小球会从(0,0)的位置落入目标区,以下为当双击的时候,只会第一次点击的setTimeout会被清除
	// 		// 所以只会显示一次从点击地点到目标区的运动
	// 		// 但是依然会执行第一次的逻辑,因为内部两个setTimeout没有被清除
	// 		clearTimeout(timer);
	// 		var timer = setTimeout(function () {
	// 			var left = event.offsetX;
	// 			var top  = event.offsetY;
	// 			// 定位球元素
	// 			var childElement = getElementMyShowHide(outerWrapper,'point-pre');
	// 			childElement.style.left = left + 'px';
	// 			childElement.style.top = top + 'px';
	// 			// 计算坐标差
	// 			var leftDifference = -(left - endLeft);
	// 			var topDifference = -(top - endTop);
	// 			// 开始
	// 			childElement.classList.remove('point-pre');
	// 			setTimeout(function () {
	// 				childElement.getElementsByClassName('inner')[0].style.transform = `translateY(${topDifference}px)`;
	// 				childElement.style.transform = `translateX(${leftDifference}px)`;
	// 				setTimeout(function () {
	// 					childElement.getElementsByClassName('inner')[0].setAttribute('style', '');
	// 					childElement.setAttribute('style', '');
	// 					childElement.classList.add('point-pre');
	// 				}, 350);
	// 			}, 1);
	// 		}, 30);
	// 	});
	// }
</script>
</body>
</html>